<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>App Social Infantil</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {
      height: 100%; margin: 0; padding: 0; box-sizing: border-box;
      font-family: 'Poppins', Arial, sans-serif;
      background: linear-gradient(135deg, #fef6e0 0%, #e0f7fa 100%);
      min-height: 100vh;
    }
    body {
      display: flex; flex-direction: column; align-items: center; justify-content: flex-start;
    }
    .container {
      background: #fffbea;
      border-radius: 22px;
      box-shadow: 0 2px 18px #c6e6f7a0;
      margin-top: 34px;
      padding: 26px 18px 20px 18px;
      width: 97vw;
      max-width: 430px;
      min-height: 420px;
      display: flex; flex-direction: column; align-items: center;
      transition: box-shadow .2s;
    }
    h1, h2 {
      color: #1988c7;
      text-align: center;
      margin-bottom: 10px;
      font-weight: 700;
    }
    h2 {
      margin-top: 12px; margin-bottom: 18px;
      font-size: 1.25rem;
    }
    .menu-btn {
      display: block;
      width: 92%;
      padding: 20px;
      margin: 16px auto;
      border: none;
      border-radius: 16px;
      background: linear-gradient(90deg, #ffd174 60%, #6ae4e7 100%);
      color: #51431e;
      font-size: 1.3rem;
      font-weight: bold;
      box-shadow: 0 3px 16px #e2dbb6aa;
      cursor: pointer;
      transition: background .22s, transform .15s;
      letter-spacing: .02em;
    }
    .menu-btn:hover { background: #ffe9b0; transform: scale(1.03); }

    /* Treinando Emo√ß√µes */
    .emotion-q {
      font-size: 1.18rem;
      margin: 0 0 28px 0;
      color: #187db7;
      background: #f1f7ff;
      border-radius: 11px;
      padding: 11px 16px;
    }
    .emoji-cards {
      display: flex;
      justify-content: center;
      gap: 22px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .emoji-card {
      width: 80px; height: 80px;
      background: #fff;
      border: 2.2px solid #f7c76a;
      border-radius: 18px;
      box-shadow: 0 2px 12px #ffe1a28f;
      font-size: 2.55rem;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer;
      transition: background .18s, transform .14s;
      user-select: none;
    }
    .emoji-card:hover { background: #fff8e3; transform: scale(1.06); }
    .feedback {
      font-size: 1.14rem;
      font-weight: 600;
      margin: 12px 0;
      min-height: 27px;
      color: #2d8c50;
      text-align: center;
      background: #e9ffef;
      border-radius: 10px;
      padding: 4px 12px;
      display: inline-block;
    }
    .score {
      margin-top: 12px;
      margin-bottom: 10px;
      color: #c37614;
      font-weight: 600;
      font-size: 1.03rem;
      letter-spacing: .01em;
    }
    .next-btn, .menu-btn-small {
      padding: 11px 23px;
      font-size: 1rem;
      border-radius: 10px;
      border: none;
      background: linear-gradient(90deg, #6ae4e7 60%, #ffd174 100%);
      color: #1c5262;
      font-weight: bold;
      margin: 8px 5px 0 5px;
      cursor: pointer;
      transition: background .22s;
    }
    .next-btn:hover, .menu-btn-small:hover { background: #d6fff6; }

    /* Rotinas Visuais */
    .rotina-list {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 18px;
      margin-top: 8px;
      margin-bottom: 15px;
    }
    .rotina-item {
      background: #f1faff;
      border: 1.5px solid #bbdefb;
      border-radius: 13px;
      padding: 16px;
      cursor: pointer;
      font-size: 1.13rem;
      font-weight: 500;
      text-align: center;
      color: #1565c0;
      transition: background .16s, transform .11s;
    }
    .rotina-item:hover { background: #fff8e1; transform: scale(1.03);}
    .passos-list {
      width: 100%;
      margin-bottom: 15px;
      margin-top: 7px;
      padding: 0;
    }
    .passo-item {
      display: flex;
      align-items: center;
      background: #fff;
      border-radius: 8px;
      margin: 9px 0;
      padding: 8px 13px;
      font-size: 1.06rem;
      color: #135c53;
      border: 1px solid #eee8c8;
      box-shadow: 0 1px 7px #d7ede7aa;
      cursor: pointer;
      transition: background .18s;
    }
    .passo-item input[type="checkbox"] {
      margin-right: 15px; width: 22px; height: 22px;
      accent-color: #ffd600;
    }
    .parabens {
      color: #388e3c;
      font-size: 1.18rem;
      font-weight: 600;
      background: #e5ffe1;
      border-radius: 13px;
      padding: 8px 12px;
      text-align: center;
      margin-bottom: 12px;
    }

    /* Simulador de Conversa */
    .chat-box {
      width: 100%;
      min-height: 200px;
      background: #f2fafe;
      border-radius: 14px;
      box-shadow: 0 2px 10px #b8e0ed44;
      padding: 17px 11px;
      margin-bottom: 16px;
      display: flex;
      flex-direction: column;
      gap: 14px;
      font-size: 1.1rem;
    }
    .chat-msg {
      background: #fff;
      padding: 9px 14px;
      border-radius: 10px;
      color: #246679;
      max-width: 85%;
      align-self: flex-start;
      box-shadow: 0 1px 5px #e2f1f788;
      word-break: break-word;
    }
    .chat-user {
      align-self: flex-end;
      background: #fce29f;
      color: #af6b07;
    }
    .chat-options {
      display: flex; gap: 13px; flex-wrap: wrap; margin-top: 5px;
    }
    .chat-option-btn {
      padding: 7px 15px;
      background: #ffe082;
      border-radius: 7px;
      border: none;
      color: #6c5705;
      font-size: 1rem;
      cursor: pointer;
      transition: background .16s;
      margin-bottom: 4px;
    }
    .chat-option-btn:hover { background: #fffde7; }

    /* Geral */
    @media (max-width: 510px) {
      .container { padding: 9px 2vw 18px 2vw; max-width: 98vw; min-height: 390px;}
      .emoji-card { width: 70px; height: 70px; font-size: 2.1rem; }
    }
  </style>
</head>
<body>
  <div class="container" id="mainContainer">
    <!-- Conte√∫do din√¢mico ser√° injetado aqui -->
  </div>
  <script>
    // --- Dados para as atividades ---
    // 1. Emo√ß√µes
    const EMOCOES = [
      { nome: "Feliz",      emoji: "üòä" },
      { nome: "Triste",     emoji: "üò¢" },
      { nome: "Bravo",      emoji: "üò°" },
      { nome: "Surpreso",   emoji: "üòÆ" }
    ];
    // Cada rodada embaralha ordem das op√ß√µes

    const EMOCOES_RODADA = [
      { pergunta: "Feliz",    correta: "üòä" },
      { pergunta: "Triste",   correta: "üò¢" },
      { pergunta: "Bravo",    correta: "üò°" },
      { pergunta: "Surpreso", correta: "üòÆ" },
      { pergunta: "Triste",   correta: "üò¢" },
      { pergunta: "Feliz",    correta: "üòä" },
      { pergunta: "Bravo",    correta: "üò°" },
      { pergunta: "Surpreso", correta: "üòÆ" }
    ];

    // 2. Rotinas Visuais
    const ROTINAS = [
      {
        nome: "Escovar os dentes",
        passos: [
          "Pegar a escova de dentes",
          "Passar creme dental",
          "Escovar os dentes (em cima e embaixo)",
          "Enxaguar a boca",
          "Guardar a escova"
        ]
      },
      {
        nome: "Trocar de roupa",
        passos: [
          "Tirar a roupa suja",
          "Escolher roupa limpa",
          "Vestir a roupa limpa",
          "Guardar roupa suja"
        ]
      },
      {
        nome: "Pedir ajuda",
        passos: [
          "Chegar perto de um adulto",
          "Olhar para ele(a)",
          "Falar ou apontar o que precisa",
          "Ouvir a resposta"
        ]
      }
    ];

    // 3. Simulador de Conversa
    const CONVERSAS = [
      {
        pergunta: "Oi! Tudo bem?",
        opcoes: ["Sim, tudo bem!", "N√£o estou bem.", "Estou com sono."],
        respostas: [
          { texto: "Que bom! Vamos brincar?", proxima: 1 },
          { texto: "Sinto muito. Quer conversar?", proxima: 2 },
          { texto: "√â importante descansar!", proxima: null }
        ]
      },
      {
        pergunta: "Vamos brincar?",
        opcoes: ["Sim!", "Agora n√£o."],
        respostas: [
          { texto: "Oba! Qual brinquedo voc√™ quer?", proxima: 3 },
          { texto: "Tudo bem, podemos brincar depois.", proxima: null }
        ]
      },
      {
        pergunta: "Quer conversar?",
        opcoes: ["Sim", "N√£o"],
        respostas: [
          { texto: "Pode me contar o que sente.", proxima: null },
          { texto: "Tudo bem, se quiser conversar depois, estarei aqui.", proxima: null }
        ]
      },
      {
        pergunta: "Qual brinquedo voc√™ quer?",
        opcoes: ["Carrinho", "Boneca", "Desenhar"],
        respostas: [
          { texto: "Carrinho √© legal!", proxima: null },
          { texto: "Boneca √© divertida!", proxima: null },
          { texto: "Desenhar √© muito criativo!", proxima: null }
        ]
      }
    ];

    // ---------------- Fun√ß√µes Utilit√°rias ----------------
    function falar(texto) {
      if ('speechSynthesis' in window) {
        const utter = new SpeechSynthesisUtterance(texto);
        utter.lang = "pt-BR";
        window.speechSynthesis.cancel(); // Interrompe qualquer fala anterior
        window.speechSynthesis.speak(utter);
      }
    }
    function embaralhar(array) {
      // Shuffle array (Fisher-Yates)
      let a = array.slice();
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }
    function voltarMenu() { renderMenu(); }

    // -------------------- Renderiza√ß√µes --------------------

    // Menu Central
    function renderMenu() {
      document.getElementById('mainContainer').innerHTML = `
        <h1>App Social Infantil</h1>
        <button class="menu-btn" onclick="renderEmocoes()">Treinando Emo√ß√µes</button>
        <button class="menu-btn" onclick="renderRotinas()">Rotinas Visuais</button>
        <button class="menu-btn" onclick="renderChat()">Simulador de Conversa</button>
        <div style="margin-top:36px; font-size:0.97em;color:#b69f53;opacity:.8;">
          Feito para auxiliar o desenvolvimento social de crian√ßas.<br><span style="font-size:0.9em">üíõ</span>
        </div>
      `;
      window.speechSynthesis.cancel();
    }

    // --- Treinando Emo√ß√µes ---
    let rodadaEmocao = 0, acertosEmocao = 0, tentandoEmocao = false;
    function renderEmocoes(iniciar = true) {
      if (iniciar) {
        rodadaEmocao = 0;
        acertosEmocao = 0;
        tentandoEmocao = false;
        EMOCOES_RODADA_EMBARALHADA = embaralhar(EMOCOES_RODADA);
      }
      if (rodadaEmocao >= EMOCOES_RODADA_EMBARALHADA.length) {
        // Fim da atividade
        document.getElementById('mainContainer').innerHTML = `
          <h2>Fim da atividade!</h2>
          <div class="score">Voc√™ acertou <b>${acertosEmocao}</b> de <b>${EMOCOES_RODADA_EMBARALHADA.length}</b> emo√ß√µes.</div>
          <button class="menu-btn-small" onclick="renderMenu()">Voltar ao menu</button>
          <button class="next-btn" onclick="renderEmocoes()">Fazer novamente</button>
        `;
        falar("Fim da atividade. Parab√©ns!");
        return;
      }
      let q = EMOCOES_RODADA_EMBARALHADA[rodadaEmocao];
      let opcoes = embaralhar(EMOCOES); // Emojis embaralhados
      let perguntaTxt = `Mostre qual √© a emo√ß√£o: "${q.pergunta}"`;
      document.getElementById('mainContainer').innerHTML = `
        <h2>Treinando Emo√ß√µes</h2>
        <div class="emotion-q" id="emoPergunta">${perguntaTxt}</div>
        <div class="emoji-cards" id="emojiCards"></div>
        <div class="feedback" id="emoFeedback"></div>
        <div class="score">Acertos: <b>${acertosEmocao}</b> de ${EMOCOES_RODADA_EMBARALHADA.length}</div>
        <button class="menu-btn-small" onclick="renderMenu()">Voltar ao menu</button>
      `;
      // Monta op√ß√µes de emoji
      let emojiDiv = document.getElementById('emojiCards');
      opcoes.forEach(emo => {
        let btn = document.createElement('div');
        btn.className = 'emoji-card';
        btn.innerText = emo.emoji;
        btn.onclick = () => selecionarEmocao(emo.emoji, q.correta);
        emojiDiv.appendChild(btn);
      });
      // Falar emo√ß√£o
      falar(q.pergunta);
    }
    function selecionarEmocao(emoji, correta) {
      let fb = document.getElementById('emoFeedback');
      if (tentandoEmocao) return; // Evita m√∫ltiplos cliques r√°pidos
      tentandoEmocao = true;
      if (emoji === correta) {
        fb.textContent = "Muito bem!";
        fb.style.color = "#1bb83c";
        acertosEmocao++;
        falar("Muito bem!");
        setTimeout(() => { rodadaEmocao++; tentandoEmocao = false; renderEmocoes(false); }, 1200);
      } else {
        fb.textContent = "Tente novamente!";
        fb.style.color = "#d1641b";
        falar("Tente novamente");
        tentandoEmocao = false;
      }
    }

    // --- Rotinas Visuais ---
    let rotinaAtual = null, passosMarcados = [];
    function renderRotinas() {
      rotinaAtual = null;
      document.getElementById('mainContainer').innerHTML = `
        <h2>Rotinas Visuais</h2>
        <div class="rotina-list">
          ${ROTINAS.map((r,i) => `<div class="rotina-item" onclick="iniciarRotina(${i})">${r.nome}</div>`).join('')}
        </div>
        <button class="menu-btn-small" onclick="renderMenu()">Voltar ao menu</button>
      `;
    }
    function iniciarRotina(idx) {
      rotinaAtual = ROTINAS[idx];
      passosMarcados = Array(rotinaAtual.passos.length).fill(false);
      renderPassosRotina();
    }
    function renderPassosRotina() {
      let passos = rotinaAtual.passos.map((p,i) =>
        `<div class="passo-item" onclick="togglePasso(${i})">
          <input type="checkbox" id="passo${i}" ${passosMarcados[i]?'checked':''} onclick="event.stopPropagation();togglePasso(${i});"/>
          ${p}
        </div>`).join('');
      document.getElementById('mainContainer').innerHTML = `
        <h2>${rotinaAtual.nome}</h2>
        <div class="passos-list">${passos}</div>
        <button class="menu-btn-small" onclick="renderRotinas()">Trocar de rotina</button>
        <button class="menu-btn-small" onclick="renderMenu()">Voltar ao menu</button>
      `;
      checarFimRotina();
    }
    function togglePasso(i) {
      passosMarcados[i] = !passosMarcados[i];
      renderPassosRotina();
    }
    function checarFimRotina() {
      if (passosMarcados.every(x=>x)) {
        document.querySelector('.passos-list').insertAdjacentHTML('afterend',`
          <div class="parabens">Voc√™ completou toda a rotina! <span style="font-size:1.5em">üéâ</span></div>
          <button class="next-btn" onclick="iniciarRotina(${ROTINAS.indexOf(rotinaAtual)})">Fazer novamente</button>
        `);
        falar("Voc√™ completou toda a rotina! Parab√©ns!");
      }
    }

    // --- Simulador de Conversa ---
    let chatHist = [], chatEtapa = 0;
    function renderChat() {
      chatHist = [];
      chatEtapa = 0;
      renderChatTela();
    }
    function renderChatTela() {
      let chat = '';
      for (let h of chatHist) {
        chat += `<div class="chat-msg">${h}</div>`;
      }
      let etapa = CONVERSAS[chatEtapa];
      chat += `<div class="chat-msg">${etapa.pergunta}</div>`;
      let opcoes = etapa.opcoes.map((o,i) =>
        `<button class="chat-option-btn" onclick="chatResponder(${i})">${o}</button>`).join('');
      document.getElementById('mainContainer').innerHTML = `
        <h2>Simulador de Conversa</h2>
        <div class="chat-box" id="chatBox">
          ${chat}
        </div>
        <div class="chat-options">${opcoes}</div>
        <button class="menu-btn-small" onclick="renderMenu()">Voltar ao menu</button>
      `;
      falar(etapa.pergunta);
    }
    function chatResponder(idx) {
      let etapa = CONVERSAS[chatEtapa];
      chatHist.push(`<span class="chat-user">${etapa.opcoes[idx]}</span>`);
      let resp = etapa.respostas[idx];
      chatHist.push(resp.texto);
      if (resp.proxima === null) {
        // Fim da conversa simulada
        document.getElementById('mainContainer').innerHTML = `
          <h2>Simulador de Conversa</h2>
          <div class="chat-box" id="chatBox">
            ${chatHist.map(m=>`<div class="chat-msg${m.includes('chat-user')?' chat-user':''}">${m}</div>`).join('')}
          </div>
          <div class="parabens" style="margin-top:6px;">Fim da conversa!</div>
          <button class="menu-btn-small" onclick="renderChat()">Fazer novamente</button>
          <button class="menu-btn-small" onclick="renderMenu()">Voltar ao menu</button>
        `;
        falar("Fim da conversa. Muito bem!");
      } else {
        chatEtapa = resp.proxima;
        setTimeout(renderChatTela, 650);
      }
    }

    // -------- Inicializa√ß√£o --------
    window.renderMenu = renderMenu;
    window.renderEmocoes = renderEmocoes;
    window.renderRotinas = renderRotinas;
    window.iniciarRotina = iniciarRotina;
    window.togglePasso = togglePasso;
    window.renderChat = renderChat;
    window.chatResponder = chatResponder;

    // Ao abrir, mostra menu
    renderMenu();
  </script>
</body>
</html>
